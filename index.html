<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Store Health Dashboard</title>

<style>
body{
    margin:0;
    font-family:Segoe UI, Arial, sans-serif;
    background:#f4f6f9;
}

/* HEADER */
.header{
    background:#1f2937;
    color:white;
    padding:15px 25px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.header h2{
    margin:0;
    font-weight:500;
}

.controls{
    display:flex;
    gap:15px;
}

select{
    padding:6px 10px;
    border-radius:6px;
    border:1px solid #ccc;
}

/* SUMMARY CARDS */
.summary{
    display:flex;
    gap:20px;
    padding:20px;
}

.card{
    flex:1;
    padding:20px;
    border-radius:10px;
    color:white;
    cursor:pointer;
    transition:0.2s;
}

.card:hover{
    transform:scale(1.03);
}

.impacted{
    background:#dc2626;
}

.healthy{
    background:#16a34a;
}

.card h3{
    margin:0;
    font-size:28px;
}

/* STORE LIST */
.section{
    padding:20px;
}

.store-card{
    background:white;
    padding:15px;
    margin-bottom:10px;
    border-radius:8px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    box-shadow:0 2px 6px rgba(0,0,0,0.05);
}

.store-card.red{
    border-left:6px solid #dc2626;
}

.store-card.green{
    border-left:6px solid #16a34a;
}

/* STORE DETAIL MODAL */
.modal{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.4);
    display:none;
    justify-content:center;
    align-items:center;
}

.modal-content{
    background:white;
    width:85%;
    max-height:85%;
    overflow:auto;
    border-radius:10px;
    padding:20px;
}

/* ZONES */
.zone{
    margin-top:20px;
}

.zone h4{
    margin-bottom:10px;
}

.terminal-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(80px,1fr));
    gap:10px;
}

.terminal{
    padding:10px;
    text-align:center;
    border-radius:6px;
    color:white;
    font-size:13px;
}

.green{ background:#16a34a; }
.red{ background:#dc2626; }

.close-btn{
    float:right;
    cursor:pointer;
    font-size:18px;
    font-weight:bold;
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
    <h2>Store Health Dashboard</h2>

    <div class="controls">
        <select id="timeFilter">
            <option value="all">All Day</option>
            <option value="30">Last 30 Min</option>
            <option value="15">Last 15 Min</option>
            <option value="24">Last 24 Hrs</option>
            <option value="48">Last 48 Hrs</option>
        </select>

        <select id="storeDropdown" onchange="openStoreFromDropdown()">
            <option value="">Select Store</option>
        </select>
    </div>
</div>

<!-- SUMMARY -->
<div class="summary">
    <div class="card impacted" onclick="filterStores('impacted')">
        <h3 id="impactedCount">0</h3>
        Impacted Stores
    </div>

    <div class="card healthy" onclick="filterStores('healthy')">
        <h3 id="healthyCount">0</h3>
        Healthy Stores
    </div>
</div>

<!-- STORE LIST -->
<div class="section" id="storeList"></div>

<!-- STORE MODAL -->
<div class="modal" id="storeModal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">âœ–</span>
        <div id="storeDetail"></div>
    </div>
</div>

<script>

/* ===========================
   DUMMY DATA GENERATION
=========================== */

const stores = [];
for(let i=1;i<=200;i++){
    let impacted = i % 7 === 0; // random impacted
    stores.push({
        id:i,
        name:"Store " + i,
        health: impacted ? 70 : 100,
        impacted: impacted,
        zones:[
            {name:"Billing Zone", terminals:createTerminals()},
            {name:"Self Checkout", terminals:createTerminals()},
            {name:"Fresh Section", terminals:createTerminals()}
        ]
    });
}

function createTerminals(){
    let arr=[];
    for(let i=1;i<=10;i++){
        let status=Math.random()>0.9?"red":"green";
        arr.push({name:"TM"+i,status});
    }
    return arr;
}

/* ===========================
   INITIAL LOAD
=========================== */

populateDropdown();
renderStores("impacted");
updateSummary();

/* ===========================
   FUNCTIONS
=========================== */

function populateDropdown(){
    const dd=document.getElementById("storeDropdown");
    stores.forEach(s=>{
        let opt=document.createElement("option");
        opt.value=s.id;
        opt.text=s.name;
        dd.appendChild(opt);
    });
}

function updateSummary(){
    const impacted=stores.filter(s=>s.impacted).length;
    const healthy=stores.filter(s=>!s.impacted).length;

    document.getElementById("impactedCount").innerText=impacted;
    document.getElementById("healthyCount").innerText=healthy;
}

function filterStores(type){
    renderStores(type);
}

function renderStores(type){
    const container=document.getElementById("storeList");
    container.innerHTML="";

    let list;
    if(type==="impacted"){
        list=stores.filter(s=>s.impacted);
    } else {
        list=stores.filter(s=>!s.impacted);
    }

    list.forEach(s=>{
        const div=document.createElement("div");
        div.className="store-card "+(s.impacted?"red":"green");
        div.innerHTML=`
            <div>
                <strong>${s.name}</strong><br>
                Health: ${s.health}%
            </div>
            <button onclick="openStore(${s.id})">View</button>
        `;
        container.appendChild(div);
    });
}

function openStore(id){
    const store=stores.find(s=>s.id===id);
    if(!store) return;

    const detail=document.getElementById("storeDetail");
    detail.innerHTML=`
        <h3>${store.name} - Health ${store.health}%</h3>
    `;

    store.zones.forEach(zone=>{
        const zoneDiv=document.createElement("div");
        zoneDiv.className="zone";
        zoneDiv.innerHTML=`<h4>${zone.name}</h4>`;

        const grid=document.createElement("div");
        grid.className="terminal-grid";

        zone.terminals.forEach(t=>{
            const tm=document.createElement("div");
            tm.className="terminal "+t.status;
            tm.innerText=t.name;
            grid.appendChild(tm);
        });

        zoneDiv.appendChild(grid);
        detail.appendChild(zoneDiv);
    });

    document.getElementById("storeModal").style.display="flex";
}

function openStoreFromDropdown(){
    const id=document.getElementById("storeDropdown").value;
    if(id) openStore(parseInt(id));
}

function closeModal(){
    document.getElementById("storeModal").style.display="none";
}

</script>

</body>
</html>
